webpackHotUpdate(0,{

/***/ 678:
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = __webpack_require__(0);\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = __webpack_require__(5);\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _reactRedux = __webpack_require__(17);\n\nvar _Discover_My_Conversations_Card = __webpack_require__(679);\n\nvar _Discover_My_Conversations_Card2 = _interopRequireDefault(_Discover_My_Conversations_Card);\n\nvar _semanticUiReact = __webpack_require__(24);\n\n__webpack_require__(203);\n\nvar _firebase = __webpack_require__(76);\n\nvar _firebase2 = _interopRequireDefault(_firebase);\n\nvar _underscore = __webpack_require__(330);\n\nvar _underscore2 = _interopRequireDefault(_underscore);\n\nvar _v = __webpack_require__(136);\n\nvar _v2 = _interopRequireDefault(_v);\n\nvar _getMyConvosThunk = __webpack_require__(728);\n\nvar _getMyConvosThunk2 = _interopRequireDefault(_getMyConvosThunk);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar MyConversationContainer = function (_React$Component) {\n  _inherits(MyConversationContainer, _React$Component);\n\n  function MyConversationContainer() {\n    _classCallCheck(this, MyConversationContainer);\n\n    var _this = _possibleConstructorReturn(this, (MyConversationContainer.__proto__ || Object.getPrototypeOf(MyConversationContainer)).call(this));\n\n    _this.state = {};\n    return _this;\n  }\n\n  _createClass(MyConversationContainer, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      if (this.props.currentUser) {\n        var followsRef = _firebase2.default.database().ref('/follows/' + this.props.currentUser.firebaseId + '/' + this.props.currentCommunity);\n        followsRef.on('value', function (snapshot) {\n          if (snapshot.val()) {\n            var follows = _underscore2.default.pairs(snapshot.val());\n            // this will filter down to only those postIds which are mapped to true\n            var myConvs = follows.filter(function (follow) {\n              return follow[1];\n            }).map(function (fol) {\n              return fol[0];\n            });\n            if (myConvs && myConvs.length > 0) {\n              _this2.props.getConvos(myConvs);\n              _this2.props.addIds(myConvs);\n            }\n          }\n        });\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      if (this.props.myConversations && this.props.myConversations.length > 0) {\n        return _react2.default.createElement(\n          'div',\n          { className: 'myConversationBox' },\n          _react2.default.createElement(\n            'p',\n            null,\n            'conversation box with infinite scroll'\n          ),\n          this.props.myConversations.map(function (conv) {\n            return _react2.default.createElement(_Discover_My_Conversations_Card2.default, { data: conv,\n              key: (0, _v2.default)() });\n          })\n        );\n      }\n      return _react2.default.createElement(\n        'div',\n        { className: 'myConversationBox' },\n        _react2.default.createElement(\n          'p',\n          null,\n          'conversation box with infinite scroll'\n        )\n      );\n    }\n  }]);\n\n  return MyConversationContainer;\n}(_react2.default.Component);\n\nMyConversationContainer.propTypes = {\n  myConversations: _propTypes2.default.array,\n  currentUser: _propTypes2.default.object,\n  currentCommunity: _propTypes2.default.string,\n  getConvos: _propTypes2.default.func,\n  addIds: _propTypes2.default.func\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    myConversations: state.conversationReducer.convos,\n    currentCommunity: state.conversationReducer.current,\n    currentUser: state.userReducer\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    getConvos: function getConvos(convos) {\n      return (0, _getMyConvosThunk2.default)(convos)(dispatch);\n    },\n    addIds: function addIds(iDs) {\n      return dispatch({ type: 'ADD_IDS', iDs: iDs });\n    }\n  };\n};\n\nexports.default = (0, _reactRedux.connect)(mapStateToProps, mapDispatchToProps)(MyConversationContainer);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjc4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vY2xpZW50L21vZHVsZXMvRGlzY292ZXIvRGlzY292ZXJfTXlfQ29udmVyc2F0aW9uX0NvbnRhaW5lci5qcz80ZGNlIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9yZWFjdCA9IHJlcXVpcmUoJ3JlYWN0Jyk7XG5cbnZhciBfcmVhY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVhY3QpO1xuXG52YXIgX3Byb3BUeXBlcyA9IHJlcXVpcmUoJ3Byb3AtdHlwZXMnKTtcblxudmFyIF9wcm9wVHlwZXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcHJvcFR5cGVzKTtcblxudmFyIF9yZWFjdFJlZHV4ID0gcmVxdWlyZSgncmVhY3QtcmVkdXgnKTtcblxudmFyIF9EaXNjb3Zlcl9NeV9Db252ZXJzYXRpb25zX0NhcmQgPSByZXF1aXJlKCcuL0Rpc2NvdmVyX015X0NvbnZlcnNhdGlvbnNfQ2FyZCcpO1xuXG52YXIgX0Rpc2NvdmVyX015X0NvbnZlcnNhdGlvbnNfQ2FyZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9EaXNjb3Zlcl9NeV9Db252ZXJzYXRpb25zX0NhcmQpO1xuXG52YXIgX3NlbWFudGljVWlSZWFjdCA9IHJlcXVpcmUoJ3NlbWFudGljLXVpLXJlYWN0Jyk7XG5cbnJlcXVpcmUoJy4vRGlzY292ZXIuY3NzJyk7XG5cbnZhciBfZmlyZWJhc2UgPSByZXF1aXJlKCcuLi8uLi9maXJlYmFzZScpO1xuXG52YXIgX2ZpcmViYXNlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ZpcmViYXNlKTtcblxudmFyIF91bmRlcnNjb3JlID0gcmVxdWlyZSgndW5kZXJzY29yZScpO1xuXG52YXIgX3VuZGVyc2NvcmUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdW5kZXJzY29yZSk7XG5cbnZhciBfdiA9IHJlcXVpcmUoJ3V1aWQvdjQnKTtcblxudmFyIF92MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3YpO1xuXG52YXIgX2dldE15Q29udm9zVGh1bmsgPSByZXF1aXJlKCcuLi8uLi90aHVua3MvdXNlcl90aHVua3MvZ2V0TXlDb252b3NUaHVuaycpO1xuXG52YXIgX2dldE15Q29udm9zVGh1bmsyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0TXlDb252b3NUaHVuayk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxudmFyIE15Q29udmVyc2F0aW9uQ29udGFpbmVyID0gZnVuY3Rpb24gKF9SZWFjdCRDb21wb25lbnQpIHtcbiAgX2luaGVyaXRzKE15Q29udmVyc2F0aW9uQ29udGFpbmVyLCBfUmVhY3QkQ29tcG9uZW50KTtcblxuICBmdW5jdGlvbiBNeUNvbnZlcnNhdGlvbkNvbnRhaW5lcigpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTXlDb252ZXJzYXRpb25Db250YWluZXIpO1xuXG4gICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKE15Q29udmVyc2F0aW9uQ29udGFpbmVyLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTXlDb252ZXJzYXRpb25Db250YWluZXIpKS5jYWxsKHRoaXMpKTtcblxuICAgIF90aGlzLnN0YXRlID0ge307XG4gICAgcmV0dXJuIF90aGlzO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKE15Q29udmVyc2F0aW9uQ29udGFpbmVyLCBbe1xuICAgIGtleTogJ2NvbXBvbmVudERpZE1vdW50JyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgaWYgKHRoaXMucHJvcHMuY3VycmVudFVzZXIpIHtcbiAgICAgICAgdmFyIGZvbGxvd3NSZWYgPSBfZmlyZWJhc2UyLmRlZmF1bHQuZGF0YWJhc2UoKS5yZWYoJy9mb2xsb3dzLycgKyB0aGlzLnByb3BzLmN1cnJlbnRVc2VyLmZpcmViYXNlSWQgKyAnLycgKyB0aGlzLnByb3BzLmN1cnJlbnRDb21tdW5pdHkpO1xuICAgICAgICBmb2xsb3dzUmVmLm9uKCd2YWx1ZScsIGZ1bmN0aW9uIChzbmFwc2hvdCkge1xuICAgICAgICAgIGlmIChzbmFwc2hvdC52YWwoKSkge1xuICAgICAgICAgICAgdmFyIGZvbGxvd3MgPSBfdW5kZXJzY29yZTIuZGVmYXVsdC5wYWlycyhzbmFwc2hvdC52YWwoKSk7XG4gICAgICAgICAgICAvLyB0aGlzIHdpbGwgZmlsdGVyIGRvd24gdG8gb25seSB0aG9zZSBwb3N0SWRzIHdoaWNoIGFyZSBtYXBwZWQgdG8gdHJ1ZVxuICAgICAgICAgICAgdmFyIG15Q29udnMgPSBmb2xsb3dzLmZpbHRlcihmdW5jdGlvbiAoZm9sbG93KSB7XG4gICAgICAgICAgICAgIHJldHVybiBmb2xsb3dbMV07XG4gICAgICAgICAgICB9KS5tYXAoZnVuY3Rpb24gKGZvbCkge1xuICAgICAgICAgICAgICByZXR1cm4gZm9sWzBdO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAobXlDb252cyAmJiBteUNvbnZzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgX3RoaXMyLnByb3BzLmdldENvbnZvcyhteUNvbnZzKTtcbiAgICAgICAgICAgICAgX3RoaXMyLnByb3BzLmFkZElkcyhteUNvbnZzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ3JlbmRlcicsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgIGlmICh0aGlzLnByb3BzLm15Q29udmVyc2F0aW9ucyAmJiB0aGlzLnByb3BzLm15Q29udmVyc2F0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJldHVybiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAnZGl2JyxcbiAgICAgICAgICB7IGNsYXNzTmFtZTogJ215Q29udmVyc2F0aW9uQm94JyB9LFxuICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgJ3AnLFxuICAgICAgICAgICAgbnVsbCxcbiAgICAgICAgICAgICdjb252ZXJzYXRpb24gYm94IHdpdGggaW5maW5pdGUgc2Nyb2xsJ1xuICAgICAgICAgICksXG4gICAgICAgICAgdGhpcy5wcm9wcy5teUNvbnZlcnNhdGlvbnMubWFwKGZ1bmN0aW9uIChjb252KSB7XG4gICAgICAgICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX0Rpc2NvdmVyX015X0NvbnZlcnNhdGlvbnNfQ2FyZDIuZGVmYXVsdCwgeyBkYXRhOiBjb252LFxuICAgICAgICAgICAgICBrZXk6ICgwLCBfdjIuZGVmYXVsdCkoKSB9KTtcbiAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAnZGl2JyxcbiAgICAgICAgeyBjbGFzc05hbWU6ICdteUNvbnZlcnNhdGlvbkJveCcgfSxcbiAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgJ3AnLFxuICAgICAgICAgIG51bGwsXG4gICAgICAgICAgJ2NvbnZlcnNhdGlvbiBib3ggd2l0aCBpbmZpbml0ZSBzY3JvbGwnXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIE15Q29udmVyc2F0aW9uQ29udGFpbmVyO1xufShfcmVhY3QyLmRlZmF1bHQuQ29tcG9uZW50KTtcblxuTXlDb252ZXJzYXRpb25Db250YWluZXIucHJvcFR5cGVzID0ge1xuICBteUNvbnZlcnNhdGlvbnM6IF9wcm9wVHlwZXMyLmRlZmF1bHQuYXJyYXksXG4gIGN1cnJlbnRVc2VyOiBfcHJvcFR5cGVzMi5kZWZhdWx0Lm9iamVjdCxcbiAgY3VycmVudENvbW11bml0eTogX3Byb3BUeXBlczIuZGVmYXVsdC5zdHJpbmcsXG4gIGdldENvbnZvczogX3Byb3BUeXBlczIuZGVmYXVsdC5mdW5jLFxuICBhZGRJZHM6IF9wcm9wVHlwZXMyLmRlZmF1bHQuZnVuY1xufTtcblxudmFyIG1hcFN0YXRlVG9Qcm9wcyA9IGZ1bmN0aW9uIG1hcFN0YXRlVG9Qcm9wcyhzdGF0ZSkge1xuICByZXR1cm4ge1xuICAgIG15Q29udmVyc2F0aW9uczogc3RhdGUuY29udmVyc2F0aW9uUmVkdWNlci5jb252b3MsXG4gICAgY3VycmVudENvbW11bml0eTogc3RhdGUuY29udmVyc2F0aW9uUmVkdWNlci5jdXJyZW50LFxuICAgIGN1cnJlbnRVc2VyOiBzdGF0ZS51c2VyUmVkdWNlclxuICB9O1xufTtcblxudmFyIG1hcERpc3BhdGNoVG9Qcm9wcyA9IGZ1bmN0aW9uIG1hcERpc3BhdGNoVG9Qcm9wcyhkaXNwYXRjaCkge1xuICByZXR1cm4ge1xuICAgIGdldENvbnZvczogZnVuY3Rpb24gZ2V0Q29udm9zKGNvbnZvcykge1xuICAgICAgcmV0dXJuICgwLCBfZ2V0TXlDb252b3NUaHVuazIuZGVmYXVsdCkoY29udm9zKShkaXNwYXRjaCk7XG4gICAgfSxcbiAgICBhZGRJZHM6IGZ1bmN0aW9uIGFkZElkcyhpRHMpIHtcbiAgICAgIHJldHVybiBkaXNwYXRjaCh7IHR5cGU6ICdBRERfSURTJywgaURzOiBpRHMgfSk7XG4gICAgfVxuICB9O1xufTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gKDAsIF9yZWFjdFJlZHV4LmNvbm5lY3QpKG1hcFN0YXRlVG9Qcm9wcywgbWFwRGlzcGF0Y2hUb1Byb3BzKShNeUNvbnZlcnNhdGlvbkNvbnRhaW5lcik7XG5cblxuLy8vLy8vLy8vLy8vLy8vLy8vXG4vLyBXRUJQQUNLIEZPT1RFUlxuLy8gLi9jbGllbnQvbW9kdWxlcy9EaXNjb3Zlci9EaXNjb3Zlcl9NeV9Db252ZXJzYXRpb25fQ29udGFpbmVyLmpzXG4vLyBtb2R1bGUgaWQgPSA2Nzhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///678\n");

/***/ }),

/***/ 697:
/***/ (function(module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = __webpack_require__(0);\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactRedux = __webpack_require__(17);\n\nvar _propTypes = __webpack_require__(5);\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _newLikeThunk = __webpack_require__(346);\n\nvar _newLikeThunk2 = _interopRequireDefault(_newLikeThunk);\n\nvar _newCommentThunk = __webpack_require__(723);\n\nvar _newCommentThunk2 = _interopRequireDefault(_newCommentThunk);\n\nvar _newCommentLikeThunk = __webpack_require__(722);\n\nvar _newCommentLikeThunk2 = _interopRequireDefault(_newCommentLikeThunk);\n\nvar _joinConversationThunk = __webpack_require__(721);\n\nvar _joinConversationThunk2 = _interopRequireDefault(_joinConversationThunk);\n\nvar _Post_Comment = __webpack_require__(695);\n\nvar _Post_Comment2 = _interopRequireDefault(_Post_Comment);\n\n__webpack_require__(135);\n\nvar _semanticUiReact = __webpack_require__(24);\n\nvar _firebase = __webpack_require__(76);\n\nvar _firebase2 = _interopRequireDefault(_firebase);\n\nvar _v = __webpack_require__(136);\n\nvar _v2 = _interopRequireDefault(_v);\n\nvar _underscore = __webpack_require__(330);\n\nvar _underscore2 = _interopRequireDefault(_underscore);\n\nvar _jquery = __webpack_require__(1373);\n\nvar _jquery2 = _interopRequireDefault(_jquery);\n\nvar _Nested_Post_Modal = __webpack_require__(694);\n\nvar _Nested_Post_Modal2 = _interopRequireDefault(_Nested_Post_Modal);\n\nvar _reactInfiniteScroller = __webpack_require__(299);\n\nvar _reactInfiniteScroller2 = _interopRequireDefault(_reactInfiniteScroller);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar ModalInstance = function (_React$Component) {\n  _inherits(ModalInstance, _React$Component);\n\n  function ModalInstance(props) {\n    _classCallCheck(this, ModalInstance);\n\n    var _this = _possibleConstructorReturn(this, (ModalInstance.__proto__ || Object.getPrototypeOf(ModalInstance)).call(this, props));\n\n    _this.state = {\n      commentBody: '',\n      messages: [],\n      hitBottom: false,\n      c: 0,\n      // TODO conversation.filter((conv) => conv._id === this.props.postData._id).length > 0\n      isInConversation: false\n    };\n    _this.scrollToBottom = _this.scrollToBottom.bind(_this);\n    return _this;\n  }\n\n  _createClass(ModalInstance, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var membersRef = _firebase2.default.database().ref('/members/' + this.props.postData.postId);\n      membersRef.on('value', function (snapshot) {\n        var peeps = _underscore2.default.values(snapshot.val());\n        var members = peeps.filter(function (peep) {\n          return peep;\n        });\n        _this2.setState({ members: members.length });\n      });\n      var countRef = _firebase2.default.database().ref('/counts/' + this.props.postData.postId + '/count');\n      countRef.on('value', function (snapshot) {\n        _this2.setState({ count: snapshot.val() });\n      });\n    }\n  }, {\n    key: 'scrollToBottom',\n    value: function scrollToBottom(id) {\n      // $('.scrolling').scrollTop(50000);\n      var elem = document.getElementById(id);\n      if (elem) {\n        elem.scrollIntoView();\n        this.setState({ hitBottom: true, c: this.state.c + 1 });\n      } else {\n        // $('.scrolling').scrollTop(100000);\n        this.setState({ hitBottom: true, c: this.state.c + 1 });\n      }\n      // } else {\n      //   const bottom = document.getElementById('bottom');\n      //   console.log('bottom', bottom);\n      //   bottom.scrollIntoView();\n      // }\n    }\n  }, {\n    key: 'loadMore',\n    value: function loadMore(data) {\n      var _this3 = this;\n\n      // const elmnt = document.getElementById(this.state.firstId);\n      // console.log('first ID', this.state.firstId, elmnt);\n      var oldId = this.state.firstId;\n      if (this.state.hitBottom) {\n        if (data.postId) {\n          var _messagesRef = _firebase2.default.database().ref('/messages/' + data.postId).orderByKey().endAt(this.state.firstKey).limitToLast(15);\n          _messagesRef.once('value', function (snapshot) {\n            var newOnes = _underscore2.default.values(snapshot.val());\n            newOnes.pop();\n            var concat = newOnes.concat(_this3.state.messages);\n            var more = newOnes.length > 0;\n            var newId = newOnes.length > 0 ? newOnes[0].authorId + '' + newOnes[0].content : '';\n            _this3.setState({ messages: concat, firstKey: Object.keys(snapshot.val())[0], firstId: newId, hitBottom: false, hasMore: more });\n            // const scrollAmount = newOnes.length * 90 + 90;\n            if (newId) {\n              _this3.scrollToBottom(oldId);\n            }\n          });\n        } else {\n          console.log('missing postData load more');\n        }\n      } else {\n        console.log('oops havent hit bottom yet :/');\n      }\n    }\n  }, {\n    key: 'handleChange',\n    value: function handleChange(e) {\n      console.log('val', e.target.value);\n      if (e.target.value) {\n        var user = _firebase2.default.auth().currentUser;\n        var updates = {};\n        var typeInfo = {\n          typer: user.displayName,\n          typerId: user.uid,\n          typerPhoto: this.props.currentUser.pictureURL\n        };\n        updates['/typers/' + this.props.postData.postId + '/' + user.uid] = typeInfo;\n        _firebase2.default.database().ref().update(updates);\n        this.setState({ commentBody: e.target.value });\n      } else {\n        var _user = _firebase2.default.auth().currentUser;\n        var _updates = {};\n        _updates['/typers/' + this.props.postData.postId + '/' + _user.uid] = false;\n        _firebase2.default.database().ref().update(_updates);\n        this.setState({ commentBody: e.target.value });\n      }\n    }\n  }, {\n    key: 'findEnter',\n    value: function findEnter() {\n      var _this4 = this;\n\n      (0, _jquery2.default)('#messageInput').keypress(function (event) {\n        if (event.which === 13) {\n          _this4.handleClick(_this4.props.postData.postId);\n          return false; // prevent duplicate submission\n        }\n        return null;\n      });\n    }\n  }, {\n    key: 'handleClick',\n    value: function handleClick(id) {\n      if (this.state.commentBody.length > 0) {\n        var user = _firebase2.default.auth().currentUser;\n        var commentBody = this.state.commentBody;\n        var split = commentBody.split(' ');\n        split.forEach(function (word, idx) {\n          if (word.length > 31) {\n            var firstHalf = word.slice(0, 32);\n            var secondHalf = word.slice(32);\n            split[idx] = firstHalf + '\\n' + secondHalf;\n          }\n        });\n        var useBody = split.join(' ');\n        var message = {\n          author: user.displayName,\n          authorId: user.uid,\n          content: useBody,\n          createdAt: new Date(),\n          authorPhoto: this.props.currentUser.pictureURL\n        };\n        this.setState({ commentBody: '' });\n        var updates = {};\n        var newMessageKey = _firebase2.default.database().ref().child('messages').push().key;\n        updates['/messages/' + id + '/' + newMessageKey] = message;\n        _firebase2.default.database().ref().update(updates);\n        var messagesCountRef = _firebase2.default.database().ref('/counts/' + this.props.postData.postId + '/count');\n        messagesCountRef.transaction(function (currentValue) {\n          return (currentValue || 0) + 1;\n        });\n      }\n      var elem = document.getElementById('messageInput');\n      elem.value = '';\n    }\n  }, {\n    key: 'startListen',\n    value: function startListen(data) {\n      var _this5 = this;\n\n      var updates = {};\n      var user = _firebase2.default.auth().currentUser;\n      updates['/members/' + this.props.postData.postId + '/' + user.uid] = true;\n      _firebase2.default.database().ref().update(updates);\n\n      if (data.postId) {\n        var _messagesRef2 = _firebase2.default.database().ref('/messages/' + data.postId).orderByKey().limitToLast(20);\n        _messagesRef2.on('value', function (snapshot) {\n          if (snapshot.val()) {\n            var send = _underscore2.default.values(snapshot.val());\n            var ID = send[0].authorId + '' + send[0].content;\n            var bottomID = send[send.length - 1].authorId + '' + send[send.length - 1].content;\n            _this5.setState({ messages: send,\n              firstKey: Object.keys(snapshot.val())[0],\n              firstId: ID,\n              hasMore: true,\n              hitBottom: true });\n            if (_this5.state.c === 0 || send[send.length - 1].authorId === user.uid) {\n              _this5.scrollToBottom(bottomID);\n            }\n          } else {\n            console.log('no snapshot val :(');\n          }\n        });\n      } else {\n        console.log('missing postData');\n      }\n    }\n  }, {\n    key: 'watchForTypers',\n    value: function watchForTypers() {\n      var _this6 = this;\n\n      var typersRef = _firebase2.default.database().ref('/typers' + this.props.postData.postId);\n      messagesRef.on('value', function (snapshot) {\n        if (snapshot.val()) {\n          var pairs = _underscore2.default.pairs(snapshot.val());\n          var typers = pairs.filter(function (pair) {\n            return pair;\n          }).map(function (typer) {\n            return typer[1];\n          });\n          _this6.setState({ typers: typers });\n        }\n      });\n    }\n  }, {\n    key: 'handleClose',\n    value: function handleClose() {\n      var updates = {};\n      var user = _firebase2.default.auth().currentUser;\n      updates['/members/' + this.props.postData.postId + '/' + user.uid] = false;\n      _firebase2.default.database().ref().update(updates);\n      this.setState({ hitBottom: false, messages: [], firstKey: null, firstId: null, commentBody: '', c: 0 });\n    }\n  }, {\n    key: 'joinConversation',\n    value: function joinConversation() {\n      var user = _firebase2.default.auth().currentUser;\n      var updates = {};\n      updates['/follows/' + user.uid + '/' + this.props.currentUser.currentCommunity._id + '/' + this.props.postData.postId] = true;\n      _firebase2.default.database().ref().update(updates);\n    }\n  }, {\n    key: 'leaveConversation',\n    value: function leaveConversation() {\n      var user = _firebase2.default.auth().currentUser;\n      var updates = {};\n      updates['/follows/' + user.uid + '/' + this.props.currentUser.currentCommunity._id + '/' + this.props.postData.postId] = false;\n      _firebase2.default.database().ref().update(updates);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this7 = this;\n\n      return _react2.default.createElement(\n        _semanticUiReact.Modal,\n        { onOpen: function onOpen() {\n            _this7.startListen(_this7.props.postData);\n          },\n          onClose: function onClose() {\n            _this7.handleClose();\n          },\n          size: 'small',\n          basic: true,\n          trigger: _react2.default.createElement(\n            'div',\n            { className: 'commentDiv' },\n            _react2.default.createElement(\n              'span',\n              { className: 'userNum' },\n              '+',\n              this.state.members > 0 ? this.state.members : ''\n            ),\n            _react2.default.createElement(_semanticUiReact.Icon, { size: 'big', name: 'users', className: 'users' }),\n            _react2.default.createElement(\n              'span',\n              { className: 'commentNum' },\n              '+',\n              this.state.count\n            ),\n            _react2.default.createElement(_semanticUiReact.Icon, { size: 'big', name: 'comments', className: 'commentIcon' })\n          ),\n          closeIcon: 'close'\n        },\n        _react2.default.createElement(\n          _semanticUiReact.Modal.Header,\n          { className: 'modalHeader' },\n          _react2.default.createElement(_Nested_Post_Modal2.default, { postData: this.props.postData,\n            currentUser: this.props.currentUser }),\n          _react2.default.createElement(\n            'div',\n            { className: 'inModalUsers' },\n            _react2.default.createElement(\n              'span',\n              { className: 'userNum' },\n              '+',\n              this.state.members > 0 ? this.state.members : ''\n            ),\n            _react2.default.createElement(_semanticUiReact.Icon, { size: 'big', name: 'users', className: 'users', color: 'grey' })\n          ),\n          this.props.myConvoIds.indexOf(this.props.postData.postId) > -1 ? _react2.default.createElement(\n            'div',\n            { className: 'joinConversation' },\n            _react2.default.createElement(\n              _semanticUiReact.Button,\n              {\n                onClick: function onClick() {\n                  return _this7.leaveConversation();\n                },\n                circular: true,\n                id: 'joinButton',\n                animated: 'vertical' },\n              _react2.default.createElement(\n                _semanticUiReact.Button.Content,\n                null,\n                'unFollow'\n              )\n            )\n          ) : _react2.default.createElement(\n            'div',\n            { className: 'joinConversation' },\n            _react2.default.createElement(\n              _semanticUiReact.Button,\n              {\n                onClick: function onClick() {\n                  return _this7.joinConversation();\n                },\n                circular: true,\n                id: 'joinButton',\n                animated: 'vertical' },\n              _react2.default.createElement(\n                _semanticUiReact.Button.Content,\n                { hidden: true },\n                'Follow'\n              ),\n              _react2.default.createElement(\n                _semanticUiReact.Button.Content,\n                { visible: true },\n                _react2.default.createElement(_semanticUiReact.Icon, { name: 'plus' })\n              )\n            )\n          )\n        ),\n        _react2.default.createElement(\n          _semanticUiReact.Modal.Content,\n          { scrolling: true, className: 'scrollContentClass' },\n          _react2.default.createElement(\n            _reactInfiniteScroller2.default,\n            {\n              pageStart: 0,\n              loadMore: function loadMore() {\n                _this7.loadMore(_this7.props.postData);\n              },\n              hasMore: this.state.hasMore,\n              isReverse: true,\n              threshold: 25,\n              loader: _react2.default.createElement(_semanticUiReact.Loader, { active: true, inline: 'centered' }),\n              useWindow: false\n            },\n            this.state.messages.map(function (message) {\n              return _react2.default.createElement(_Post_Comment2.default, {\n                id: message.authorId + '' + message.content,\n                key: (0, _v2.default)(),\n                name: message.author,\n                createdAt: message.createdAt,\n                content: message.content,\n                authorPhoto: message.authorPhoto,\n                currentUser: _this7.props.currentUser,\n                authorId: message.authorId\n              });\n            }),\n            _react2.default.createElement('div', { id: 'bottom' })\n          )\n        ),\n        _react2.default.createElement(\n          _semanticUiReact.Modal.Actions,\n          null,\n          _react2.default.createElement(\n            _semanticUiReact.Form,\n            null,\n            _react2.default.createElement(_semanticUiReact.TextArea, {\n              id: 'messageInput',\n              autoHeight: true,\n              placeholder: 'Give your two cents...',\n              onChange: function onChange(e) {\n                _this7.handleChange(e);_this7.findEnter();\n              },\n              rows: 3\n            })\n          )\n        )\n      );\n    }\n  }]);\n\n  return ModalInstance;\n}(_react2.default.Component);\n\nModalInstance.propTypes = {\n  postData: _propTypes2.default.object,\n  newComment: _propTypes2.default.func,\n  onClick: _propTypes2.default.func,\n  newLike: _propTypes2.default.func,\n  newCommentLike: _propTypes2.default.func,\n  currentUser: _propTypes2.default.object,\n  startListen: _propTypes2.default.func,\n  joinConversation: _propTypes2.default.func,\n  myConvoIds: _propTypes2.default.array\n};\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    myConvoIds: state.conversationReducer.iDs\n  };\n};\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    newLike: function newLike(id) {\n      return (0, _newLikeThunk2.default)(id)(dispatch);\n    },\n    joinConversation: function joinConversation(postId) {\n      return dispatch((0, _joinConversationThunk2.default)(postId));\n    },\n    newComment: function newComment(commentBody, postId) {\n      return (0, _newCommentThunk2.default)(commentBody, postId)(dispatch);\n    },\n    newCommentLike: function newCommentLike(postId, commentId) {\n      return (0, _newCommentLikeThunk2.default)(postId, commentId)(dispatch);\n    }\n  };\n};\nexports.default = (0, _reactRedux.connect)(mapStateToProps, mapDispatchToProps)(ModalInstance);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNjk3LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vY2xpZW50L21vZHVsZXMvUG9zdC9Qb3N0X01vZGFsX0NvbnRhaW5lci5qcz9mMmYyIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9yZWFjdCA9IHJlcXVpcmUoJ3JlYWN0Jyk7XG5cbnZhciBfcmVhY3QyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVhY3QpO1xuXG52YXIgX3JlYWN0UmVkdXggPSByZXF1aXJlKCdyZWFjdC1yZWR1eCcpO1xuXG52YXIgX3Byb3BUeXBlcyA9IHJlcXVpcmUoJ3Byb3AtdHlwZXMnKTtcblxudmFyIF9wcm9wVHlwZXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcHJvcFR5cGVzKTtcblxudmFyIF9uZXdMaWtlVGh1bmsgPSByZXF1aXJlKCcuLi8uLi90aHVua3MvcG9zdF90aHVua3MvbmV3TGlrZVRodW5rJyk7XG5cbnZhciBfbmV3TGlrZVRodW5rMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX25ld0xpa2VUaHVuayk7XG5cbnZhciBfbmV3Q29tbWVudFRodW5rID0gcmVxdWlyZSgnLi4vLi4vdGh1bmtzL3Bvc3RfdGh1bmtzL25ld0NvbW1lbnRUaHVuaycpO1xuXG52YXIgX25ld0NvbW1lbnRUaHVuazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9uZXdDb21tZW50VGh1bmspO1xuXG52YXIgX25ld0NvbW1lbnRMaWtlVGh1bmsgPSByZXF1aXJlKCcuLi8uLi90aHVua3MvcG9zdF90aHVua3MvbmV3Q29tbWVudExpa2VUaHVuaycpO1xuXG52YXIgX25ld0NvbW1lbnRMaWtlVGh1bmsyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbmV3Q29tbWVudExpa2VUaHVuayk7XG5cbnZhciBfam9pbkNvbnZlcnNhdGlvblRodW5rID0gcmVxdWlyZSgnLi4vLi4vdGh1bmtzL3Bvc3RfdGh1bmtzL2pvaW5Db252ZXJzYXRpb25UaHVuaycpO1xuXG52YXIgX2pvaW5Db252ZXJzYXRpb25UaHVuazIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9qb2luQ29udmVyc2F0aW9uVGh1bmspO1xuXG52YXIgX1Bvc3RfQ29tbWVudCA9IHJlcXVpcmUoJy4vUG9zdF9Db21tZW50Jyk7XG5cbnZhciBfUG9zdF9Db21tZW50MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX1Bvc3RfQ29tbWVudCk7XG5cbnJlcXVpcmUoJy4vUG9zdC5jc3MnKTtcblxudmFyIF9zZW1hbnRpY1VpUmVhY3QgPSByZXF1aXJlKCdzZW1hbnRpYy11aS1yZWFjdCcpO1xuXG52YXIgX2ZpcmViYXNlID0gcmVxdWlyZSgnLi4vLi4vZmlyZWJhc2UnKTtcblxudmFyIF9maXJlYmFzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9maXJlYmFzZSk7XG5cbnZhciBfdiA9IHJlcXVpcmUoJ3V1aWQvdjQnKTtcblxudmFyIF92MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3YpO1xuXG52YXIgX3VuZGVyc2NvcmUgPSByZXF1aXJlKCd1bmRlcnNjb3JlJyk7XG5cbnZhciBfdW5kZXJzY29yZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91bmRlcnNjb3JlKTtcblxudmFyIF9qcXVlcnkgPSByZXF1aXJlKCdqcXVlcnknKTtcblxudmFyIF9qcXVlcnkyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfanF1ZXJ5KTtcblxudmFyIF9OZXN0ZWRfUG9zdF9Nb2RhbCA9IHJlcXVpcmUoJy4vTmVzdGVkX1Bvc3RfTW9kYWwnKTtcblxudmFyIF9OZXN0ZWRfUG9zdF9Nb2RhbDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9OZXN0ZWRfUG9zdF9Nb2RhbCk7XG5cbnZhciBfcmVhY3RJbmZpbml0ZVNjcm9sbGVyID0gcmVxdWlyZSgncmVhY3QtaW5maW5pdGUtc2Nyb2xsZXInKTtcblxudmFyIF9yZWFjdEluZmluaXRlU2Nyb2xsZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVhY3RJbmZpbml0ZVNjcm9sbGVyKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG52YXIgTW9kYWxJbnN0YW5jZSA9IGZ1bmN0aW9uIChfUmVhY3QkQ29tcG9uZW50KSB7XG4gIF9pbmhlcml0cyhNb2RhbEluc3RhbmNlLCBfUmVhY3QkQ29tcG9uZW50KTtcblxuICBmdW5jdGlvbiBNb2RhbEluc3RhbmNlKHByb3BzKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1vZGFsSW5zdGFuY2UpO1xuXG4gICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKE1vZGFsSW5zdGFuY2UuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihNb2RhbEluc3RhbmNlKSkuY2FsbCh0aGlzLCBwcm9wcykpO1xuXG4gICAgX3RoaXMuc3RhdGUgPSB7XG4gICAgICBjb21tZW50Qm9keTogJycsXG4gICAgICBtZXNzYWdlczogW10sXG4gICAgICBoaXRCb3R0b206IGZhbHNlLFxuICAgICAgYzogMCxcbiAgICAgIC8vIFRPRE8gY29udmVyc2F0aW9uLmZpbHRlcigoY29udikgPT4gY29udi5faWQgPT09IHRoaXMucHJvcHMucG9zdERhdGEuX2lkKS5sZW5ndGggPiAwXG4gICAgICBpc0luQ29udmVyc2F0aW9uOiBmYWxzZVxuICAgIH07XG4gICAgX3RoaXMuc2Nyb2xsVG9Cb3R0b20gPSBfdGhpcy5zY3JvbGxUb0JvdHRvbS5iaW5kKF90aGlzKTtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoTW9kYWxJbnN0YW5jZSwgW3tcbiAgICBrZXk6ICdjb21wb25lbnREaWRNb3VudCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgIHZhciBtZW1iZXJzUmVmID0gX2ZpcmViYXNlMi5kZWZhdWx0LmRhdGFiYXNlKCkucmVmKCcvbWVtYmVycy8nICsgdGhpcy5wcm9wcy5wb3N0RGF0YS5wb3N0SWQpO1xuICAgICAgbWVtYmVyc1JlZi5vbigndmFsdWUnLCBmdW5jdGlvbiAoc25hcHNob3QpIHtcbiAgICAgICAgdmFyIHBlZXBzID0gX3VuZGVyc2NvcmUyLmRlZmF1bHQudmFsdWVzKHNuYXBzaG90LnZhbCgpKTtcbiAgICAgICAgdmFyIG1lbWJlcnMgPSBwZWVwcy5maWx0ZXIoZnVuY3Rpb24gKHBlZXApIHtcbiAgICAgICAgICByZXR1cm4gcGVlcDtcbiAgICAgICAgfSk7XG4gICAgICAgIF90aGlzMi5zZXRTdGF0ZSh7IG1lbWJlcnM6IG1lbWJlcnMubGVuZ3RoIH0pO1xuICAgICAgfSk7XG4gICAgICB2YXIgY291bnRSZWYgPSBfZmlyZWJhc2UyLmRlZmF1bHQuZGF0YWJhc2UoKS5yZWYoJy9jb3VudHMvJyArIHRoaXMucHJvcHMucG9zdERhdGEucG9zdElkICsgJy9jb3VudCcpO1xuICAgICAgY291bnRSZWYub24oJ3ZhbHVlJywgZnVuY3Rpb24gKHNuYXBzaG90KSB7XG4gICAgICAgIF90aGlzMi5zZXRTdGF0ZSh7IGNvdW50OiBzbmFwc2hvdC52YWwoKSB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ3Njcm9sbFRvQm90dG9tJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2Nyb2xsVG9Cb3R0b20oaWQpIHtcbiAgICAgIC8vICQoJy5zY3JvbGxpbmcnKS5zY3JvbGxUb3AoNTAwMDApO1xuICAgICAgdmFyIGVsZW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7XG4gICAgICBpZiAoZWxlbSkge1xuICAgICAgICBlbGVtLnNjcm9sbEludG9WaWV3KCk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBoaXRCb3R0b206IHRydWUsIGM6IHRoaXMuc3RhdGUuYyArIDEgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyAkKCcuc2Nyb2xsaW5nJykuc2Nyb2xsVG9wKDEwMDAwMCk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBoaXRCb3R0b206IHRydWUsIGM6IHRoaXMuc3RhdGUuYyArIDEgfSk7XG4gICAgICB9XG4gICAgICAvLyB9IGVsc2Uge1xuICAgICAgLy8gICBjb25zdCBib3R0b20gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYm90dG9tJyk7XG4gICAgICAvLyAgIGNvbnNvbGUubG9nKCdib3R0b20nLCBib3R0b20pO1xuICAgICAgLy8gICBib3R0b20uc2Nyb2xsSW50b1ZpZXcoKTtcbiAgICAgIC8vIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdsb2FkTW9yZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWRNb3JlKGRhdGEpIHtcbiAgICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgICAvLyBjb25zdCBlbG1udCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuc3RhdGUuZmlyc3RJZCk7XG4gICAgICAvLyBjb25zb2xlLmxvZygnZmlyc3QgSUQnLCB0aGlzLnN0YXRlLmZpcnN0SWQsIGVsbW50KTtcbiAgICAgIHZhciBvbGRJZCA9IHRoaXMuc3RhdGUuZmlyc3RJZDtcbiAgICAgIGlmICh0aGlzLnN0YXRlLmhpdEJvdHRvbSkge1xuICAgICAgICBpZiAoZGF0YS5wb3N0SWQpIHtcbiAgICAgICAgICB2YXIgX21lc3NhZ2VzUmVmID0gX2ZpcmViYXNlMi5kZWZhdWx0LmRhdGFiYXNlKCkucmVmKCcvbWVzc2FnZXMvJyArIGRhdGEucG9zdElkKS5vcmRlckJ5S2V5KCkuZW5kQXQodGhpcy5zdGF0ZS5maXJzdEtleSkubGltaXRUb0xhc3QoMTUpO1xuICAgICAgICAgIF9tZXNzYWdlc1JlZi5vbmNlKCd2YWx1ZScsIGZ1bmN0aW9uIChzbmFwc2hvdCkge1xuICAgICAgICAgICAgdmFyIG5ld09uZXMgPSBfdW5kZXJzY29yZTIuZGVmYXVsdC52YWx1ZXMoc25hcHNob3QudmFsKCkpO1xuICAgICAgICAgICAgbmV3T25lcy5wb3AoKTtcbiAgICAgICAgICAgIHZhciBjb25jYXQgPSBuZXdPbmVzLmNvbmNhdChfdGhpczMuc3RhdGUubWVzc2FnZXMpO1xuICAgICAgICAgICAgdmFyIG1vcmUgPSBuZXdPbmVzLmxlbmd0aCA+IDA7XG4gICAgICAgICAgICB2YXIgbmV3SWQgPSBuZXdPbmVzLmxlbmd0aCA+IDAgPyBuZXdPbmVzWzBdLmF1dGhvcklkICsgJycgKyBuZXdPbmVzWzBdLmNvbnRlbnQgOiAnJztcbiAgICAgICAgICAgIF90aGlzMy5zZXRTdGF0ZSh7IG1lc3NhZ2VzOiBjb25jYXQsIGZpcnN0S2V5OiBPYmplY3Qua2V5cyhzbmFwc2hvdC52YWwoKSlbMF0sIGZpcnN0SWQ6IG5ld0lkLCBoaXRCb3R0b206IGZhbHNlLCBoYXNNb3JlOiBtb3JlIH0pO1xuICAgICAgICAgICAgLy8gY29uc3Qgc2Nyb2xsQW1vdW50ID0gbmV3T25lcy5sZW5ndGggKiA5MCArIDkwO1xuICAgICAgICAgICAgaWYgKG5ld0lkKSB7XG4gICAgICAgICAgICAgIF90aGlzMy5zY3JvbGxUb0JvdHRvbShvbGRJZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ21pc3NpbmcgcG9zdERhdGEgbG9hZCBtb3JlJyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdvb3BzIGhhdmVudCBoaXQgYm90dG9tIHlldCA6LycpO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2hhbmRsZUNoYW5nZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZUNoYW5nZShlKSB7XG4gICAgICBjb25zb2xlLmxvZygndmFsJywgZS50YXJnZXQudmFsdWUpO1xuICAgICAgaWYgKGUudGFyZ2V0LnZhbHVlKSB7XG4gICAgICAgIHZhciB1c2VyID0gX2ZpcmViYXNlMi5kZWZhdWx0LmF1dGgoKS5jdXJyZW50VXNlcjtcbiAgICAgICAgdmFyIHVwZGF0ZXMgPSB7fTtcbiAgICAgICAgdmFyIHR5cGVJbmZvID0ge1xuICAgICAgICAgIHR5cGVyOiB1c2VyLmRpc3BsYXlOYW1lLFxuICAgICAgICAgIHR5cGVySWQ6IHVzZXIudWlkLFxuICAgICAgICAgIHR5cGVyUGhvdG86IHRoaXMucHJvcHMuY3VycmVudFVzZXIucGljdHVyZVVSTFxuICAgICAgICB9O1xuICAgICAgICB1cGRhdGVzWycvdHlwZXJzLycgKyB0aGlzLnByb3BzLnBvc3REYXRhLnBvc3RJZCArICcvJyArIHVzZXIudWlkXSA9IHR5cGVJbmZvO1xuICAgICAgICBfZmlyZWJhc2UyLmRlZmF1bHQuZGF0YWJhc2UoKS5yZWYoKS51cGRhdGUodXBkYXRlcyk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBjb21tZW50Qm9keTogZS50YXJnZXQudmFsdWUgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgX3VzZXIgPSBfZmlyZWJhc2UyLmRlZmF1bHQuYXV0aCgpLmN1cnJlbnRVc2VyO1xuICAgICAgICB2YXIgX3VwZGF0ZXMgPSB7fTtcbiAgICAgICAgX3VwZGF0ZXNbJy90eXBlcnMvJyArIHRoaXMucHJvcHMucG9zdERhdGEucG9zdElkICsgJy8nICsgX3VzZXIudWlkXSA9IGZhbHNlO1xuICAgICAgICBfZmlyZWJhc2UyLmRlZmF1bHQuZGF0YWJhc2UoKS5yZWYoKS51cGRhdGUoX3VwZGF0ZXMpO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgY29tbWVudEJvZHk6IGUudGFyZ2V0LnZhbHVlIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2ZpbmRFbnRlcicsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmRFbnRlcigpIHtcbiAgICAgIHZhciBfdGhpczQgPSB0aGlzO1xuXG4gICAgICAoMCwgX2pxdWVyeTIuZGVmYXVsdCkoJyNtZXNzYWdlSW5wdXQnKS5rZXlwcmVzcyhmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgaWYgKGV2ZW50LndoaWNoID09PSAxMykge1xuICAgICAgICAgIF90aGlzNC5oYW5kbGVDbGljayhfdGhpczQucHJvcHMucG9zdERhdGEucG9zdElkKTtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7IC8vIHByZXZlbnQgZHVwbGljYXRlIHN1Ym1pc3Npb25cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2hhbmRsZUNsaWNrJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlQ2xpY2soaWQpIHtcbiAgICAgIGlmICh0aGlzLnN0YXRlLmNvbW1lbnRCb2R5Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgdmFyIHVzZXIgPSBfZmlyZWJhc2UyLmRlZmF1bHQuYXV0aCgpLmN1cnJlbnRVc2VyO1xuICAgICAgICB2YXIgY29tbWVudEJvZHkgPSB0aGlzLnN0YXRlLmNvbW1lbnRCb2R5O1xuICAgICAgICB2YXIgc3BsaXQgPSBjb21tZW50Qm9keS5zcGxpdCgnICcpO1xuICAgICAgICBzcGxpdC5mb3JFYWNoKGZ1bmN0aW9uICh3b3JkLCBpZHgpIHtcbiAgICAgICAgICBpZiAod29yZC5sZW5ndGggPiAzMSkge1xuICAgICAgICAgICAgdmFyIGZpcnN0SGFsZiA9IHdvcmQuc2xpY2UoMCwgMzIpO1xuICAgICAgICAgICAgdmFyIHNlY29uZEhhbGYgPSB3b3JkLnNsaWNlKDMyKTtcbiAgICAgICAgICAgIHNwbGl0W2lkeF0gPSBmaXJzdEhhbGYgKyAnXFxuJyArIHNlY29uZEhhbGY7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgdmFyIHVzZUJvZHkgPSBzcGxpdC5qb2luKCcgJyk7XG4gICAgICAgIHZhciBtZXNzYWdlID0ge1xuICAgICAgICAgIGF1dGhvcjogdXNlci5kaXNwbGF5TmFtZSxcbiAgICAgICAgICBhdXRob3JJZDogdXNlci51aWQsXG4gICAgICAgICAgY29udGVudDogdXNlQm9keSxcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgICAgYXV0aG9yUGhvdG86IHRoaXMucHJvcHMuY3VycmVudFVzZXIucGljdHVyZVVSTFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgY29tbWVudEJvZHk6ICcnIH0pO1xuICAgICAgICB2YXIgdXBkYXRlcyA9IHt9O1xuICAgICAgICB2YXIgbmV3TWVzc2FnZUtleSA9IF9maXJlYmFzZTIuZGVmYXVsdC5kYXRhYmFzZSgpLnJlZigpLmNoaWxkKCdtZXNzYWdlcycpLnB1c2goKS5rZXk7XG4gICAgICAgIHVwZGF0ZXNbJy9tZXNzYWdlcy8nICsgaWQgKyAnLycgKyBuZXdNZXNzYWdlS2V5XSA9IG1lc3NhZ2U7XG4gICAgICAgIF9maXJlYmFzZTIuZGVmYXVsdC5kYXRhYmFzZSgpLnJlZigpLnVwZGF0ZSh1cGRhdGVzKTtcbiAgICAgICAgdmFyIG1lc3NhZ2VzQ291bnRSZWYgPSBfZmlyZWJhc2UyLmRlZmF1bHQuZGF0YWJhc2UoKS5yZWYoJy9jb3VudHMvJyArIHRoaXMucHJvcHMucG9zdERhdGEucG9zdElkICsgJy9jb3VudCcpO1xuICAgICAgICBtZXNzYWdlc0NvdW50UmVmLnRyYW5zYWN0aW9uKGZ1bmN0aW9uIChjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICByZXR1cm4gKGN1cnJlbnRWYWx1ZSB8fCAwKSArIDE7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgdmFyIGVsZW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWVzc2FnZUlucHV0Jyk7XG4gICAgICBlbGVtLnZhbHVlID0gJyc7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnc3RhcnRMaXN0ZW4nLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzdGFydExpc3RlbihkYXRhKSB7XG4gICAgICB2YXIgX3RoaXM1ID0gdGhpcztcblxuICAgICAgdmFyIHVwZGF0ZXMgPSB7fTtcbiAgICAgIHZhciB1c2VyID0gX2ZpcmViYXNlMi5kZWZhdWx0LmF1dGgoKS5jdXJyZW50VXNlcjtcbiAgICAgIHVwZGF0ZXNbJy9tZW1iZXJzLycgKyB0aGlzLnByb3BzLnBvc3REYXRhLnBvc3RJZCArICcvJyArIHVzZXIudWlkXSA9IHRydWU7XG4gICAgICBfZmlyZWJhc2UyLmRlZmF1bHQuZGF0YWJhc2UoKS5yZWYoKS51cGRhdGUodXBkYXRlcyk7XG5cbiAgICAgIGlmIChkYXRhLnBvc3RJZCkge1xuICAgICAgICB2YXIgX21lc3NhZ2VzUmVmMiA9IF9maXJlYmFzZTIuZGVmYXVsdC5kYXRhYmFzZSgpLnJlZignL21lc3NhZ2VzLycgKyBkYXRhLnBvc3RJZCkub3JkZXJCeUtleSgpLmxpbWl0VG9MYXN0KDIwKTtcbiAgICAgICAgX21lc3NhZ2VzUmVmMi5vbigndmFsdWUnLCBmdW5jdGlvbiAoc25hcHNob3QpIHtcbiAgICAgICAgICBpZiAoc25hcHNob3QudmFsKCkpIHtcbiAgICAgICAgICAgIHZhciBzZW5kID0gX3VuZGVyc2NvcmUyLmRlZmF1bHQudmFsdWVzKHNuYXBzaG90LnZhbCgpKTtcbiAgICAgICAgICAgIHZhciBJRCA9IHNlbmRbMF0uYXV0aG9ySWQgKyAnJyArIHNlbmRbMF0uY29udGVudDtcbiAgICAgICAgICAgIHZhciBib3R0b21JRCA9IHNlbmRbc2VuZC5sZW5ndGggLSAxXS5hdXRob3JJZCArICcnICsgc2VuZFtzZW5kLmxlbmd0aCAtIDFdLmNvbnRlbnQ7XG4gICAgICAgICAgICBfdGhpczUuc2V0U3RhdGUoeyBtZXNzYWdlczogc2VuZCxcbiAgICAgICAgICAgICAgZmlyc3RLZXk6IE9iamVjdC5rZXlzKHNuYXBzaG90LnZhbCgpKVswXSxcbiAgICAgICAgICAgICAgZmlyc3RJZDogSUQsXG4gICAgICAgICAgICAgIGhhc01vcmU6IHRydWUsXG4gICAgICAgICAgICAgIGhpdEJvdHRvbTogdHJ1ZSB9KTtcbiAgICAgICAgICAgIGlmIChfdGhpczUuc3RhdGUuYyA9PT0gMCB8fCBzZW5kW3NlbmQubGVuZ3RoIC0gMV0uYXV0aG9ySWQgPT09IHVzZXIudWlkKSB7XG4gICAgICAgICAgICAgIF90aGlzNS5zY3JvbGxUb0JvdHRvbShib3R0b21JRCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdubyBzbmFwc2hvdCB2YWwgOignKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coJ21pc3NpbmcgcG9zdERhdGEnKTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICd3YXRjaEZvclR5cGVycycsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHdhdGNoRm9yVHlwZXJzKCkge1xuICAgICAgdmFyIF90aGlzNiA9IHRoaXM7XG5cbiAgICAgIHZhciB0eXBlcnNSZWYgPSBfZmlyZWJhc2UyLmRlZmF1bHQuZGF0YWJhc2UoKS5yZWYoJy90eXBlcnMnICsgdGhpcy5wcm9wcy5wb3N0RGF0YS5wb3N0SWQpO1xuICAgICAgbWVzc2FnZXNSZWYub24oJ3ZhbHVlJywgZnVuY3Rpb24gKHNuYXBzaG90KSB7XG4gICAgICAgIGlmIChzbmFwc2hvdC52YWwoKSkge1xuICAgICAgICAgIHZhciBwYWlycyA9IF91bmRlcnNjb3JlMi5kZWZhdWx0LnBhaXJzKHNuYXBzaG90LnZhbCgpKTtcbiAgICAgICAgICB2YXIgdHlwZXJzID0gcGFpcnMuZmlsdGVyKGZ1bmN0aW9uIChwYWlyKSB7XG4gICAgICAgICAgICByZXR1cm4gcGFpcjtcbiAgICAgICAgICB9KS5tYXAoZnVuY3Rpb24gKHR5cGVyKSB7XG4gICAgICAgICAgICByZXR1cm4gdHlwZXJbMV07XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgX3RoaXM2LnNldFN0YXRlKHsgdHlwZXJzOiB0eXBlcnMgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2hhbmRsZUNsb3NlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlQ2xvc2UoKSB7XG4gICAgICB2YXIgdXBkYXRlcyA9IHt9O1xuICAgICAgdmFyIHVzZXIgPSBfZmlyZWJhc2UyLmRlZmF1bHQuYXV0aCgpLmN1cnJlbnRVc2VyO1xuICAgICAgdXBkYXRlc1snL21lbWJlcnMvJyArIHRoaXMucHJvcHMucG9zdERhdGEucG9zdElkICsgJy8nICsgdXNlci51aWRdID0gZmFsc2U7XG4gICAgICBfZmlyZWJhc2UyLmRlZmF1bHQuZGF0YWJhc2UoKS5yZWYoKS51cGRhdGUodXBkYXRlcyk7XG4gICAgICB0aGlzLnNldFN0YXRlKHsgaGl0Qm90dG9tOiBmYWxzZSwgbWVzc2FnZXM6IFtdLCBmaXJzdEtleTogbnVsbCwgZmlyc3RJZDogbnVsbCwgY29tbWVudEJvZHk6ICcnLCBjOiAwIH0pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2pvaW5Db252ZXJzYXRpb24nLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBqb2luQ29udmVyc2F0aW9uKCkge1xuICAgICAgdmFyIHVzZXIgPSBfZmlyZWJhc2UyLmRlZmF1bHQuYXV0aCgpLmN1cnJlbnRVc2VyO1xuICAgICAgdmFyIHVwZGF0ZXMgPSB7fTtcbiAgICAgIHVwZGF0ZXNbJy9mb2xsb3dzLycgKyB1c2VyLnVpZCArICcvJyArIHRoaXMucHJvcHMuY3VycmVudFVzZXIuY3VycmVudENvbW11bml0eS5faWQgKyAnLycgKyB0aGlzLnByb3BzLnBvc3REYXRhLnBvc3RJZF0gPSB0cnVlO1xuICAgICAgX2ZpcmViYXNlMi5kZWZhdWx0LmRhdGFiYXNlKCkucmVmKCkudXBkYXRlKHVwZGF0ZXMpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2xlYXZlQ29udmVyc2F0aW9uJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gbGVhdmVDb252ZXJzYXRpb24oKSB7XG4gICAgICB2YXIgdXNlciA9IF9maXJlYmFzZTIuZGVmYXVsdC5hdXRoKCkuY3VycmVudFVzZXI7XG4gICAgICB2YXIgdXBkYXRlcyA9IHt9O1xuICAgICAgdXBkYXRlc1snL2ZvbGxvd3MvJyArIHVzZXIudWlkICsgJy8nICsgdGhpcy5wcm9wcy5jdXJyZW50VXNlci5jdXJyZW50Q29tbXVuaXR5Ll9pZCArICcvJyArIHRoaXMucHJvcHMucG9zdERhdGEucG9zdElkXSA9IGZhbHNlO1xuICAgICAgX2ZpcmViYXNlMi5kZWZhdWx0LmRhdGFiYXNlKCkucmVmKCkudXBkYXRlKHVwZGF0ZXMpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ3JlbmRlcicsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlcigpIHtcbiAgICAgIHZhciBfdGhpczcgPSB0aGlzO1xuXG4gICAgICByZXR1cm4gX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgIF9zZW1hbnRpY1VpUmVhY3QuTW9kYWwsXG4gICAgICAgIHsgb25PcGVuOiBmdW5jdGlvbiBvbk9wZW4oKSB7XG4gICAgICAgICAgICBfdGhpczcuc3RhcnRMaXN0ZW4oX3RoaXM3LnByb3BzLnBvc3REYXRhKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIG9uQ2xvc2U6IGZ1bmN0aW9uIG9uQ2xvc2UoKSB7XG4gICAgICAgICAgICBfdGhpczcuaGFuZGxlQ2xvc2UoKTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNpemU6ICdzbWFsbCcsXG4gICAgICAgICAgYmFzaWM6IHRydWUsXG4gICAgICAgICAgdHJpZ2dlcjogX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAnZGl2JyxcbiAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAnY29tbWVudERpdicgfSxcbiAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAnc3BhbicsXG4gICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAndXNlck51bScgfSxcbiAgICAgICAgICAgICAgJysnLFxuICAgICAgICAgICAgICB0aGlzLnN0YXRlLm1lbWJlcnMgPiAwID8gdGhpcy5zdGF0ZS5tZW1iZXJzIDogJydcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc2VtYW50aWNVaVJlYWN0Lkljb24sIHsgc2l6ZTogJ2JpZycsIG5hbWU6ICd1c2VycycsIGNsYXNzTmFtZTogJ3VzZXJzJyB9KSxcbiAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAnc3BhbicsXG4gICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAnY29tbWVudE51bScgfSxcbiAgICAgICAgICAgICAgJysnLFxuICAgICAgICAgICAgICB0aGlzLnN0YXRlLmNvdW50XG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3NlbWFudGljVWlSZWFjdC5JY29uLCB7IHNpemU6ICdiaWcnLCBuYW1lOiAnY29tbWVudHMnLCBjbGFzc05hbWU6ICdjb21tZW50SWNvbicgfSlcbiAgICAgICAgICApLFxuICAgICAgICAgIGNsb3NlSWNvbjogJ2Nsb3NlJ1xuICAgICAgICB9LFxuICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICBfc2VtYW50aWNVaVJlYWN0Lk1vZGFsLkhlYWRlcixcbiAgICAgICAgICB7IGNsYXNzTmFtZTogJ21vZGFsSGVhZGVyJyB9LFxuICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9OZXN0ZWRfUG9zdF9Nb2RhbDIuZGVmYXVsdCwgeyBwb3N0RGF0YTogdGhpcy5wcm9wcy5wb3N0RGF0YSxcbiAgICAgICAgICAgIGN1cnJlbnRVc2VyOiB0aGlzLnByb3BzLmN1cnJlbnRVc2VyIH0pLFxuICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgJ2RpdicsXG4gICAgICAgICAgICB7IGNsYXNzTmFtZTogJ2luTW9kYWxVc2VycycgfSxcbiAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgICAnc3BhbicsXG4gICAgICAgICAgICAgIHsgY2xhc3NOYW1lOiAndXNlck51bScgfSxcbiAgICAgICAgICAgICAgJysnLFxuICAgICAgICAgICAgICB0aGlzLnN0YXRlLm1lbWJlcnMgPiAwID8gdGhpcy5zdGF0ZS5tZW1iZXJzIDogJydcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc2VtYW50aWNVaVJlYWN0Lkljb24sIHsgc2l6ZTogJ2JpZycsIG5hbWU6ICd1c2VycycsIGNsYXNzTmFtZTogJ3VzZXJzJywgY29sb3I6ICdncmV5JyB9KVxuICAgICAgICAgICksXG4gICAgICAgICAgdGhpcy5wcm9wcy5teUNvbnZvSWRzLmluZGV4T2YodGhpcy5wcm9wcy5wb3N0RGF0YS5wb3N0SWQpID4gLTEgPyBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICdkaXYnLFxuICAgICAgICAgICAgeyBjbGFzc05hbWU6ICdqb2luQ29udmVyc2F0aW9uJyB9LFxuICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgIF9zZW1hbnRpY1VpUmVhY3QuQnV0dG9uLFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczcubGVhdmVDb252ZXJzYXRpb24oKTtcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGNpcmN1bGFyOiB0cnVlLFxuICAgICAgICAgICAgICAgIGlkOiAnam9pbkJ1dHRvbicsXG4gICAgICAgICAgICAgICAgYW5pbWF0ZWQ6ICd2ZXJ0aWNhbCcgfSxcbiAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgX3NlbWFudGljVWlSZWFjdC5CdXR0b24uQ29udGVudCxcbiAgICAgICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgICAgICd1bkZvbGxvdydcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKVxuICAgICAgICAgICkgOiBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICdkaXYnLFxuICAgICAgICAgICAgeyBjbGFzc05hbWU6ICdqb2luQ29udmVyc2F0aW9uJyB9LFxuICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgIF9zZW1hbnRpY1VpUmVhY3QuQnV0dG9uLFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgb25DbGljazogZnVuY3Rpb24gb25DbGljaygpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczcuam9pbkNvbnZlcnNhdGlvbigpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY2lyY3VsYXI6IHRydWUsXG4gICAgICAgICAgICAgICAgaWQ6ICdqb2luQnV0dG9uJyxcbiAgICAgICAgICAgICAgICBhbmltYXRlZDogJ3ZlcnRpY2FsJyB9LFxuICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChcbiAgICAgICAgICAgICAgICBfc2VtYW50aWNVaVJlYWN0LkJ1dHRvbi5Db250ZW50LFxuICAgICAgICAgICAgICAgIHsgaGlkZGVuOiB0cnVlIH0sXG4gICAgICAgICAgICAgICAgJ0ZvbGxvdydcbiAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICAgICAgX3NlbWFudGljVWlSZWFjdC5CdXR0b24uQ29udGVudCxcbiAgICAgICAgICAgICAgICB7IHZpc2libGU6IHRydWUgfSxcbiAgICAgICAgICAgICAgICBfcmVhY3QyLmRlZmF1bHQuY3JlYXRlRWxlbWVudChfc2VtYW50aWNVaVJlYWN0Lkljb24sIHsgbmFtZTogJ3BsdXMnIH0pXG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgIClcbiAgICAgICAgICApXG4gICAgICAgICksXG4gICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgIF9zZW1hbnRpY1VpUmVhY3QuTW9kYWwuQ29udGVudCxcbiAgICAgICAgICB7IHNjcm9sbGluZzogdHJ1ZSwgY2xhc3NOYW1lOiAnc2Nyb2xsQ29udGVudENsYXNzJyB9LFxuICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KFxuICAgICAgICAgICAgX3JlYWN0SW5maW5pdGVTY3JvbGxlcjIuZGVmYXVsdCxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgcGFnZVN0YXJ0OiAwLFxuICAgICAgICAgICAgICBsb2FkTW9yZTogZnVuY3Rpb24gbG9hZE1vcmUoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXM3LmxvYWRNb3JlKF90aGlzNy5wcm9wcy5wb3N0RGF0YSk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGhhc01vcmU6IHRoaXMuc3RhdGUuaGFzTW9yZSxcbiAgICAgICAgICAgICAgaXNSZXZlcnNlOiB0cnVlLFxuICAgICAgICAgICAgICB0aHJlc2hvbGQ6IDI1LFxuICAgICAgICAgICAgICBsb2FkZXI6IF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9zZW1hbnRpY1VpUmVhY3QuTG9hZGVyLCB7IGFjdGl2ZTogdHJ1ZSwgaW5saW5lOiAnY2VudGVyZWQnIH0pLFxuICAgICAgICAgICAgICB1c2VXaW5kb3c6IGZhbHNlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdGhpcy5zdGF0ZS5tZXNzYWdlcy5tYXAoZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KF9Qb3N0X0NvbW1lbnQyLmRlZmF1bHQsIHtcbiAgICAgICAgICAgICAgICBpZDogbWVzc2FnZS5hdXRob3JJZCArICcnICsgbWVzc2FnZS5jb250ZW50LFxuICAgICAgICAgICAgICAgIGtleTogKDAsIF92Mi5kZWZhdWx0KSgpLFxuICAgICAgICAgICAgICAgIG5hbWU6IG1lc3NhZ2UuYXV0aG9yLFxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogbWVzc2FnZS5jcmVhdGVkQXQsXG4gICAgICAgICAgICAgICAgY29udGVudDogbWVzc2FnZS5jb250ZW50LFxuICAgICAgICAgICAgICAgIGF1dGhvclBob3RvOiBtZXNzYWdlLmF1dGhvclBob3RvLFxuICAgICAgICAgICAgICAgIGN1cnJlbnRVc2VyOiBfdGhpczcucHJvcHMuY3VycmVudFVzZXIsXG4gICAgICAgICAgICAgICAgYXV0aG9ySWQ6IG1lc3NhZ2UuYXV0aG9ySWRcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICAgIF9yZWFjdDIuZGVmYXVsdC5jcmVhdGVFbGVtZW50KCdkaXYnLCB7IGlkOiAnYm90dG9tJyB9KVxuICAgICAgICAgIClcbiAgICAgICAgKSxcbiAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgX3NlbWFudGljVWlSZWFjdC5Nb2RhbC5BY3Rpb25zLFxuICAgICAgICAgIG51bGwsXG4gICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoXG4gICAgICAgICAgICBfc2VtYW50aWNVaVJlYWN0LkZvcm0sXG4gICAgICAgICAgICBudWxsLFxuICAgICAgICAgICAgX3JlYWN0Mi5kZWZhdWx0LmNyZWF0ZUVsZW1lbnQoX3NlbWFudGljVWlSZWFjdC5UZXh0QXJlYSwge1xuICAgICAgICAgICAgICBpZDogJ21lc3NhZ2VJbnB1dCcsXG4gICAgICAgICAgICAgIGF1dG9IZWlnaHQ6IHRydWUsXG4gICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAnR2l2ZSB5b3VyIHR3byBjZW50cy4uLicsXG4gICAgICAgICAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiBvbkNoYW5nZShlKSB7XG4gICAgICAgICAgICAgICAgX3RoaXM3LmhhbmRsZUNoYW5nZShlKTtfdGhpczcuZmluZEVudGVyKCk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIHJvd3M6IDNcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgKVxuICAgICAgICApXG4gICAgICApO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBNb2RhbEluc3RhbmNlO1xufShfcmVhY3QyLmRlZmF1bHQuQ29tcG9uZW50KTtcblxuTW9kYWxJbnN0YW5jZS5wcm9wVHlwZXMgPSB7XG4gIHBvc3REYXRhOiBfcHJvcFR5cGVzMi5kZWZhdWx0Lm9iamVjdCxcbiAgbmV3Q29tbWVudDogX3Byb3BUeXBlczIuZGVmYXVsdC5mdW5jLFxuICBvbkNsaWNrOiBfcHJvcFR5cGVzMi5kZWZhdWx0LmZ1bmMsXG4gIG5ld0xpa2U6IF9wcm9wVHlwZXMyLmRlZmF1bHQuZnVuYyxcbiAgbmV3Q29tbWVudExpa2U6IF9wcm9wVHlwZXMyLmRlZmF1bHQuZnVuYyxcbiAgY3VycmVudFVzZXI6IF9wcm9wVHlwZXMyLmRlZmF1bHQub2JqZWN0LFxuICBzdGFydExpc3RlbjogX3Byb3BUeXBlczIuZGVmYXVsdC5mdW5jLFxuICBqb2luQ29udmVyc2F0aW9uOiBfcHJvcFR5cGVzMi5kZWZhdWx0LmZ1bmMsXG4gIG15Q29udm9JZHM6IF9wcm9wVHlwZXMyLmRlZmF1bHQuYXJyYXlcbn07XG52YXIgbWFwU3RhdGVUb1Byb3BzID0gZnVuY3Rpb24gbWFwU3RhdGVUb1Byb3BzKHN0YXRlKSB7XG4gIHJldHVybiB7XG4gICAgbXlDb252b0lkczogc3RhdGUuY29udmVyc2F0aW9uUmVkdWNlci5pRHNcbiAgfTtcbn07XG52YXIgbWFwRGlzcGF0Y2hUb1Byb3BzID0gZnVuY3Rpb24gbWFwRGlzcGF0Y2hUb1Byb3BzKGRpc3BhdGNoKSB7XG4gIHJldHVybiB7XG4gICAgbmV3TGlrZTogZnVuY3Rpb24gbmV3TGlrZShpZCkge1xuICAgICAgcmV0dXJuICgwLCBfbmV3TGlrZVRodW5rMi5kZWZhdWx0KShpZCkoZGlzcGF0Y2gpO1xuICAgIH0sXG4gICAgam9pbkNvbnZlcnNhdGlvbjogZnVuY3Rpb24gam9pbkNvbnZlcnNhdGlvbihwb3N0SWQpIHtcbiAgICAgIHJldHVybiBkaXNwYXRjaCgoMCwgX2pvaW5Db252ZXJzYXRpb25UaHVuazIuZGVmYXVsdCkocG9zdElkKSk7XG4gICAgfSxcbiAgICBuZXdDb21tZW50OiBmdW5jdGlvbiBuZXdDb21tZW50KGNvbW1lbnRCb2R5LCBwb3N0SWQpIHtcbiAgICAgIHJldHVybiAoMCwgX25ld0NvbW1lbnRUaHVuazIuZGVmYXVsdCkoY29tbWVudEJvZHksIHBvc3RJZCkoZGlzcGF0Y2gpO1xuICAgIH0sXG4gICAgbmV3Q29tbWVudExpa2U6IGZ1bmN0aW9uIG5ld0NvbW1lbnRMaWtlKHBvc3RJZCwgY29tbWVudElkKSB7XG4gICAgICByZXR1cm4gKDAsIF9uZXdDb21tZW50TGlrZVRodW5rMi5kZWZhdWx0KShwb3N0SWQsIGNvbW1lbnRJZCkoZGlzcGF0Y2gpO1xuICAgIH1cbiAgfTtcbn07XG5leHBvcnRzLmRlZmF1bHQgPSAoMCwgX3JlYWN0UmVkdXguY29ubmVjdCkobWFwU3RhdGVUb1Byb3BzLCBtYXBEaXNwYXRjaFRvUHJvcHMpKE1vZGFsSW5zdGFuY2UpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vY2xpZW50L21vZHVsZXMvUG9zdC9Qb3N0X01vZGFsX0NvbnRhaW5lci5qc1xuLy8gbW9kdWxlIGlkID0gNjk3XG4vLyBtb2R1bGUgY2h1bmtzID0gMCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///697\n");

/***/ })

})